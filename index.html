<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Absolute de Nicaragua</title>
  <link rel="stylesheet" href="./styles/app.css">
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>

 <!-- Barra de t√≠tulo personalizada -->
<div class="title-bar">
  <div class="app-title">
    <img src="assets/icon.ico" alt="Logo" style="width:20px; height:20px; vertical-align:middle; margin-right:8px;">
    Absolute de Nicaragua
  </div>
  <div class="window-controls">
    <!-- Botones de desarrollo (solo en modo no empaquetado) -->
    <button id="reload-btn" class="window-btn dev-btn" title="Recargar (Ctrl+R)">‚ü≥</button>
    <button id="clear-cache-btn" class="window-btn dev-btn" title="Limpiar cach√© y recargar">üßπ</button>
    <!-- Controles reales de ventana -->
    <button id="minimize-btn" class="window-btn minimize">‚Äî</button>
    <button id="maximize-btn" class="window-btn maximize">‚ñ°</button>
    <button id="close-btn" class="window-btn close">√ó</button>
  </div>
</div>

  <!-- Pesta√±as principales -->
  <div class="tabs">
    <button class="tab active" data-tab="inicio">Inicio</button>
    <button class="tab" data-tab="modulos">M√≥dulos</button>
    <button class="tab" data-tab="reportes">Reportes</button>
    <button class="tab" data-tab="recetas">Recetas</button>
    <button class="tab" data-tab="ayuda">Ayuda</button>
  </div>

  <!-- Paneles desplegables -->
  <div class="panels">
    <!-- Inicio -->
    <div class="panel active" id="panel-inicio">
      <button id="btn-login" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
          <polyline points="10 17 15 12 10 7"></polyline>
          <line x1="15" y1="12" x2="3" y2="12"></line>
        </svg>
        <span>Iniciar sesi√≥n</span>
      </button>
      <button id="btn-crear-usuario" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <line x1="19" y1="8" x2="19" y2="14"></line>
          <line x1="22" y1="11" x2="16" y2="11"></line>
        </svg>
        <span>Crear usuario</span>
      </button>
      <button id="btn-cerrar-sesion" class="ribbon-btn" aria-label="Cerrar sesi√≥n">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        <span>Cerrar sesi√≥n</span>
      </button>
    </div>

    <!-- M√≥dulos -->
    <div class="panel" id="panel-modulos">
      <button id="btn-ventas" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart-icon lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
        <span>Ventas</span>
      </button>
      <button id="btn-bodega" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-warehouse-icon lucide-warehouse"><path d="M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11"/><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z"/><path d="M6 13h12"/><path d="M6 17h12"/></svg>
        <span>Bodega</span>
      </button>
      <!-- ‚úÖ RENOMBRADO: "Personal" ‚Üí "Recursos Humanos" -->
      <button id="btn-rrhh" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <span>Recursos Humanos</span>
      </button>
       <button id="btn-logistica" class="ribbon-btn">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor-cloud-icon lucide-monitor-cloud"><path d="M11 13a3 3 0 1 1 2.83-4H14a2 2 0 0 1 0 4z"/><path d="M12 17v4"/><path d="M8 21h8"/><rect x="2" y="3" width="20" height="14" rx="2"/></svg>
        <span>Log√≠stica</span>
      </button>
      <button id="btn-contabilidad" class="ribbon-btn">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calculator">
    <rect width="16" height="20" x="4" y="2" rx="2"/>
    <line x1="8" y1="6" x2="16" y2="6"/>
    <line x1="16" y1="14" x2="16" y2="18"/>
    <path d="M16 10h.01"/>
    <path d="M12 10h.01"/>
    <path d="M8 10h.01"/>
    <path d="M12 14h.01"/>
    <path d="M8 14h.01"/>
    <path d="M12 18h.01"/>
    <path d="M8 18h.01"/>
  </svg>
  <span>Contabilidad</span>
</button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clapperboard-icon lucide-clapperboard"><path d="M20.2 6l-17.55.88L3.88.88c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.88,7L7,7l7,7z"/><path d="m7,7 l5,5"/><path d="m7,7 l5,5"/><path d="M3,7 h5"/><path d="M3,7 h5"/></svg>
        <span>Eventos</span>
      </button>
    </div>

    <!-- Reportes -->
    <div class="panel" id="panel-reportes">
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-presentation-icon lucide-presentation"><path d="M2 3h20"/><path d="M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3"/><path d="m7 21 5-5 5 5"/></svg>
        <span>Resumen de Eventos</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-tabs-icon lucide-notebook-tabs"><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><rect width="16" height="20" x="4" y="2" rx="2"/><path d="M15 2v20"/><path d="M15 7h5"/><path d="M15 12h5"/><path d="M15 17h5"/></svg>
        <span>Catalogo</span>
      </button>
      <!-- ‚úÖ ACTUALIZADO: Reportes de RRHH -->
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-icon lucide-notebook"><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><rect width="16" height="20" x="4" y="2" rx="2"/><path d="M16 2v20"/></svg>
        <span>Manual de contrataciones</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hand-coins-icon lucide-hand-coins"><path d="M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17"/><path d="m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9"/><path d="m2 16 6 6"/><circle cx="16" cy="9" r="2.9"/><circle cx="6" cy="5" r="3"/></svg>
        <span>Pagos eventual</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        <span>Viaticos</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2l2 2-2 2-2-2 2-2z"></path>
          <path d="M12 6l2 2-2 2-2-2 2-2z"></path>
          <path d="M12 10l2 2-2 2-2-2 2-2z"></path>
        </svg>
        <span>Rendimientos de Vehiculos</span>
      </button>
    </div>

    <!-- Recetas -->
    <div class="panel" id="panel-recetas">
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 9v4"></path>
          <path d="M9.5 12h5"></path>
          <path d="M7.5 7h9"></path>
          <path d="M9 4h6"></path>
          <path d="M12 2v2"></path>
          <path d="M5.5 11h-2"></path>
          <path d="M18.5 11h-2"></path>
          <path d="M21 18a3 3 0 0 0-3-3H6a3 3 0 0 0-3 3v1"></path>
        </svg>
        <span>Receta 1</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 10v6"></path>
          <path d="M8 13h8"></path>
          <path d="M4 19a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1z"></path>
          <path d="M5 10V6a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v4"></path>
        </svg>
        <span>Receta 2</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        <span>Nueva receta</span>
      </button>
    </div>

    <!-- Ayuda -->
    <div class="panel" id="panel-ayuda">
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <span>Acerca de</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 9a2 2 0 0 1-2 2H8m6 0a2 2 0 0 0-2-2H8"></path>
          <path d="M8 21a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4"></path>
        </svg>
        <span>Gu√≠a r√°pida</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 9v2m0 4v.01"></path>
          <path d="M5 12a7 7 0 1 1 14 0 7 7 0 0 1-14 0z"></path>
        </svg>
        <span>Soluci√≥n</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4-4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          <line x1="9" y1="10" x2="15" y2="10"></line>
          <line x1="9" y1="14" x2="15" y2="14"></line>
        </svg>
        <span>Soporte</span>
      </button>
      <button class="ribbon-btn" id="btn-actualizaciones">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 3v6h4"></path>
          <path d="M12 21v-6h4"></path>
          <path d="M16 12H9a4 4 0 0 0-4 4v1a3 3 0 0 0 3 3h8"></path>
          <path d="M8 12H3a3 3 0 0 0 3-3V8a4 4 0 0 1 4-4h1"></path>
        </svg>
        <span>Actualizaciones</span>
      </button>
    </div>
  </div>

  <!-- √Årea de contenido CON ID -->
  <div class="content-area" id="contenido-principal">
    <h2>Bienvenido a Absolute de Nicaragua</h2>
    <p>Selecciona una pesta√±a y un bot√≥n para comenzar.</p>
  </div>

  <script>
    // =============================================================================  
    // üîπ CARGAR M√ìDULOS DIN√ÅMICAMENTE
    // =============================================================================  
    function cargarModulo(url) {
        const contenedor = document.getElementById('contenido-principal');
        fetch(url)
          .then(async response => {
            if (!response.ok) throw new Error(`Error al cargar ${url}`);
            const html = await response.text();
            return { html, response };
          })
          .then(({ html, response }) => {
            try {
              const parser = new DOMParser();
              const doc = parser.parseFromString(html, 'text/html');

              // Inyectar hojas de estilo encontradas en la respuesta
              const links = Array.from(doc.querySelectorAll('link[rel="stylesheet"]'));
              links.forEach(l => {
                try {
                  const href = l.getAttribute('href');
                  if (!href) return;
                  const resolved = new URL(href, response.url).href;
                  const exists = Array.from(document.head.querySelectorAll('link[rel="stylesheet"]'))
                    .some(h => h.href === resolved || h.getAttribute('href') === href || h.href.endsWith(href));
                  if (!exists) {
                    const linkTag = document.createElement('link');
                    linkTag.rel = 'stylesheet';
                    linkTag.href = resolved;
                    document.head.appendChild(linkTag);
                  }
                } catch (e) { console.warn('failed to inject stylesheet', e); }
              });

              // Extraer body y scripts
              const bodyHtml = doc.body.innerHTML;
              const scripts = Array.from(doc.querySelectorAll('script'));

              // Insertar HTML
              contenedor.innerHTML = bodyHtml;

              // Inyectar scripts (resolver src relativo a la respuesta)
              scripts.forEach(s => {
                const tag = document.createElement('script');
                if (s.src) {
                  try {
                    const srcAttr = s.getAttribute('src');
                    tag.src = srcAttr ? new URL(srcAttr, response.url).href : s.src;
                  } catch (e) { tag.src = s.src; }
                } else {
                  tag.textContent = s.textContent;
                }
                contenedor.appendChild(tag);
              });
              return;
            } catch (e) {
              console.error('Error procesando m√≥dulo:', e);
            }

            // Fallback
            contenedor.innerHTML = html;
          })
          .catch(err => {
            console.error(err);
            contenedor.innerHTML = `<p style="color: red; padding: 20px;">‚ùå Error al cargar el m√≥dulo: ${err.message}</p>`;
          });
    }

    // =============================================================================  
    // üîπ EVENTOS DE BOTONES
    // =============================================================================  
   // Handler movido a renderer.js con control de sesi√≥n; evitamos cargar log√≠stica sin login.

    // Puedes a√±adir m√°s botones aqu√≠
    // document.getElementById('btn-bodega').addEventListener('click', () => {
    //   cargarModulo('modules/bodega/inventario.html');
    // });

    // =============================================================================  
    // üîπ PESTA√ëAS (mant√©n tu l√≥gica actual)
    // =============================================================================  
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(`panel-${tab.dataset.tab}`).classList.add('active');
      });
    });
  </script>

  <script src="./renderer.js"></script>
  <script src="./libs/jspdf.min.js"></script>
  <script src="./libs/html2canvas.min.js"></script>
  <script src="./libs/html2pdf.min.js"></script>
  <script src="./libs/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- 1. Supabase SDK (desde CDN) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- 2. Tu cliente de Supabase -->
<script src="src/config/supabaseClient.js"></script>

<!-- 3. Renderer (tu l√≥gica de app) -->
<script src="desktop/renderer.js"></script>

</body>
</html>