<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Absolute de Nicaragua</title>
  <link rel="stylesheet" href="./styles/app.css">
  <style>
    /* Reset b√°sico para login */
    .login-wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      min-height: 100vh;
    }

    .login-card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      width: 100%;
      max-width: 400px;
      padding: 32px;
    }
    .login-card h2 {
      text-align: center;
      color: #1e40af;
      margin-bottom: 24px;
      font-size: 24px;
    }

    .input-group {
      margin-bottom: 18px;
    }
    .input-group label {
      display: block;
      margin-bottom: 6px;
      color: #374151;
      font-weight: 600;
      font-size: 14px;
    }
    .input-group input {
      width: 100%;
      padding: 12px 14px;
      border: 1px solid #d1d5db;
      border-radius: 8px;
      font-size: 15px;
      transition: border-color .2s;
    }
    .input-group input:focus {
      outline: none;
      border-color: #3b82f6;
      box-shadow: 0 0 0 3px rgba(59,130,246,.2);
    }

    .btn {
      width: 100%;
      padding: 12px;
      background: #3b82f6;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: background .2s;
    }
    .btn:hover {
      background: #2563eb;
    }

    .face-wrap {
      display: flex;
      justify-content: center;
      margin-bottom: 12px;
      padding: 10px;
      background: transparent;
    }
    .face-img {
      width: 120px;
      height: 120px;
      object-fit: contain;
      transition: transform 0.3s ease, opacity 0.3s ease;
      user-select: none;
      display: block;
      border-radius: 8px;
      background: transparent;
    }
    .face-img.attentive {
      transform: translateY(-4px) scale(1.05);
    }
    .face-img.cover {
      transform: translateY(-2px) scale(1.02);
      opacity: 0.95;
    }
    @keyframes bounce-slight {
      0% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
      100% { transform: translateY(0); }
    }
    .face-img.bounce {
      animation: bounce-slight 600ms ease;
    }

    .footer-links {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: #6b7280;
    }
    .footer-links a {
      color: #3b82f6;
      text-decoration: none;
      margin-left: 8px;
    }
    /* Network banner in tabs */
    .tabs { display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .tab-left { display:flex; gap:8px; align-items:center; }
    .tab-right { display:flex; align-items:center; }
    .network-banner { background: #fff3cd; color:#856404; border:1px solid #ffeeba; padding:6px 10px; border-radius:6px; display:flex; align-items:center; gap:8px; font-size:13px; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    .network-banner.hidden { display:none; }
    .network-banner-btn { background:#ffc107; border:none; color:#212529; padding:4px 8px; border-radius:4px; cursor:pointer; }
    .network-banner-link { background:transparent; border:none; color:#856404; text-decoration:underline; cursor:pointer; padding:4px 6px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
</head>
<body>

    </div>
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        const btnSet = document.getElementById('btn-set-dns');
        const btnRestore = document.getElementById('btn-restore-dns');
        if (btnSet) btnSet.addEventListener('click', async () => {
          if (window.openDnsHelpModal) window.openDnsHelpModal();
        });
        if (btnRestore) btnRestore.addEventListener('click', async () => {
          if (window.openDnsHelpModal) window.openDnsHelpModal();
        });
        
        // Network banner helpers (global)
        const banner = document.getElementById('network-banner');
        const bannerMsg = document.getElementById('network-banner-msg');
        const bannerRetry = document.getElementById('network-banner-retry');
        const bannerHelp = document.getElementById('network-banner-help');

        window.showNetworkBanner = function(message){
          if (bannerMsg) bannerMsg.textContent = message || 'Problema de red (DNS) ‚Äî algunos servicios pueden no responder.';
          if (banner) banner.classList.remove('hidden');
        };
        window.hideNetworkBanner = function(){ if (banner) banner.classList.add('hidden'); };

        if (bannerRetry) bannerRetry.addEventListener('click', () => {
          // Emitir evento global para que los m√≥dulos reintenten sus operaciones
          document.dispatchEvent(new CustomEvent('network-retry'));
        });
        if (bannerHelp) bannerHelp.addEventListener('click', () => {
          if (window.openDnsHelpModal) window.openDnsHelpModal();
        });
        // Modal DNS controls
        const modalDns = document.getElementById('modal-dns-help');
        const modalDnsClose = document.getElementById('modal-dns-close');
        const modalRunSet = document.getElementById('modal-run-set-dns');
        const modalRunRestore = document.getElementById('modal-run-restore-dns');
        const modalShowManual = document.getElementById('modal-show-manual');
        const manualSteps = document.getElementById('manual-steps');
        const manualStepsPre = document.getElementById('manual-steps-pre');
        let dnsHelpLoaded = false;

        window.openDnsHelpModal = async function(){
          try{
            if (modalDns) modalDns.style.display = 'block';
            if (!dnsHelpLoaded){
              const resp = await fetch('assets/help/dns_help.txt');
              if (resp.ok){
                const txt = await resp.text();
                if (manualStepsPre) manualStepsPre.textContent = txt;
                dnsHelpLoaded = true;
              }
            }
          }catch(e){ console.error('Error loading DNS help text', e); }
        };

        if (modalDnsClose) modalDnsClose.addEventListener('click', () => { if (modalDns) modalDns.style.display = 'none'; });
        if (modalRunSet) modalRunSet.addEventListener('click', async () => {
          if (!confirm('Ejecutar soluci√≥n autom√°tica en este equipo?')) return;
          try {
            const res = await window.electronAPI.runSetDns();
            if (res && res.started) alert('Script iniciado. Consulta la consola del sistema para salida.');
            else alert('No se pudo iniciar: ' + (res && res.error ? res.error : 'desconocido'));
          } catch (err) { alert('Error: ' + (err && err.message ? err.message : String(err))); }
        });
        if (modalRunRestore) modalRunRestore.addEventListener('click', async () => {
          if (!confirm('Restaurar DNS a configuraci√≥n previa en este equipo?')) return;
          try {
            const res = await window.electronAPI.runRestoreDns();
            if (res && res.started) alert('Script iniciado. Consulta la consola del sistema para salida.');
            else alert('No se pudo iniciar: ' + (res && res.error ? res.error : 'desconocido'));
          } catch (err) { alert('Error: ' + (err && err.message ? err.message : String(err))); }
        });
        const modalOpenTools = document.getElementById('modal-open-tools');
        const modalCopyCommands = document.getElementById('modal-copy-commands');
        if (modalOpenTools) modalOpenTools.addEventListener('click', async () => {
          try {
            const res = await window.electronAPI.openToolsFolder();
            if (res && res.opened) alert('Carpeta de scripts abierta.');
            else if (res && res.error) alert('Error: ' + res.error);
          } catch (e) { alert('Error: ' + (e && e.message ? e.message : String(e))); }
        });
        if (modalCopyCommands) modalCopyCommands.addEventListener('click', async () => {
          try {
            const txt = manualStepsPre ? manualStepsPre.textContent : '';
            if (!txt) { alert('No hay comandos cargados. Abre "Mostrar pasos manuales" primero.'); return; }
            await navigator.clipboard.writeText(txt);
            alert('Comandos copiados al portapapeles.');
          } catch (e) { alert('No se pudo copiar: ' + (e && e.message ? e.message : String(e))); }
        });
        if (modalShowManual) modalShowManual.addEventListener('click', () => {
          if (manualSteps) manualSteps.style.display = (manualSteps.style.display === 'none' || manualSteps.style.display === '') ? 'block' : 'none';
        });
      });
    </script>
 <!-- Barra de t√≠tulo personalizada -->
<div class="title-bar">
  <div class="app-title">
    <img src="assets/icon.ico" alt="Logo" style="width:20px; height:20px; vertical-align:middle; margin-right:8px;">
    Absolute de Nicaragua
  </div>
  <div class="window-controls">
    <!-- Botones de desarrollo (solo en modo no empaquetado) -->
    <button id="reload-btn" class="window-btn dev-btn" title="Recargar (Ctrl+R)">‚ü≥</button>
    <button id="clear-cache-btn" class="window-btn dev-btn" title="Limpiar cach√© y recargar">üßπ</button>
    <!-- Controles reales de ventana -->
    <button id="minimize-btn" class="window-btn minimize">‚Äî</button>
    <button id="maximize-btn" class="window-btn maximize">‚ñ°</button>
    <button id="close-btn" class="window-btn close">√ó</button>
  </div>
</div>
  <!-- Modal: Ayuda DNS / pasos manuales -->
  <div id="modal-dns-help" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 720px;">
      <div class="modal-header">
        <h3>Soluci√≥n - Problemas de DNS</h3>
        <button id="modal-dns-close" class="modal-close">‚úï</button>
      </div>
      <div class="modal-body" style="max-height:60vh; overflow:auto;">
        <p>Si ves errores de resoluci√≥n DNS (por ejemplo "DNS address could not be found"), aqu√≠ tienes dos opciones:</p>
        <ol>
          <li><strong>Soluci√≥n autom√°tica:</strong> Ejecutar el script que actualiza los DNS del equipo a servidores p√∫blicos (Cloudflare/Google).</li>
          <li><strong>Soluci√≥n manual:</strong> Pasos para cambiar la DNS desde PowerShell (se muestran abajo).</li>
        </ol>

        <div style="display:flex; gap:10px; margin:12px 0; flex-wrap:wrap;">
          <button id="modal-run-set-dns" class="ribbon-btn" style="background:#0d6efd;color:white;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;">Ejecutar soluci√≥n autom√°tica</button>
          <button id="modal-run-restore-dns" class="ribbon-btn" style="background:#6c757d;color:white;border:none;padding:8px 12px;border-radius:6px;cursor:pointer;">Restaurar DNS autom√°tica</button>
          <button id="modal-show-manual" class="ribbon-btn" style="background:transparent;border:1px solid #ddd;padding:8px 12px;border-radius:6px;">Mostrar pasos manuales</button>
          <button id="modal-open-tools" class="ribbon-btn" style="background:#198754;color:white;border:none;padding:8px 12px;border-radius:6px;">Abrir carpeta de scripts</button>
          <button id="modal-copy-commands" class="ribbon-btn" style="background:#0dcaf0;color:#04263a;border:none;padding:8px 12px;border-radius:6px;">Copiar comandos</button>
        </div>

        <div id="manual-steps" style="display:none; background:#f8f9fa; padding:12px; border-radius:6px; border:1px solid #eee;">
          <h4>Pasos manuales (PowerShell)</h4>
          <p>Abre PowerShell como Administrador y copia/pega los siguientes comandos:</p>
          <pre id="manual-steps-pre" style="background:#fff;padding:8px;border-radius:4px;border:1px solid #e6e6e6;overflow:auto;"></pre>
          <p>Si no tienes permisos, pide a tu administrador que ejecute los comandos o utiliza la opci√≥n autom√°tica si tu cuenta lo permite.</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Pesta√±as principales + indicador de red -->
  <div class="tabs">
    <div class="tab-left">
      <button class="tab active" data-tab="inicio">Inicio</button>
      <button class="tab" data-tab="modulos">M√≥dulos</button>
      <button class="tab" data-tab="reportes">Reportes</button>
      <button class="tab" data-tab="recetas">Recetas</button>
      <button class="tab" data-tab="ayuda">Ayuda</button>
    </div>
    <div class="tab-right">
      <div id="network-banner" class="network-banner hidden" role="status" aria-live="polite">
        <span id="network-banner-msg">Problema de red (DNS) ‚Äî algunos servicios pueden no responder.</span>
        <button id="network-banner-retry" class="network-banner-btn">Reintentar</button>
        <button id="network-banner-help" class="network-banner-link">Ayuda</button>
      </div>
    </div>
  </div>

  <!-- Paneles desplegables -->
  <div class="panels">
    <!-- Inicio -->
    <div class="panel active" id="panel-inicio">
      <button id="btn-login" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
          <polyline points="10 17 15 12 10 7"></polyline>
          <line x1="15" y1="12" x2="3" y2="12"></line>
        </svg>
        <span>Iniciar sesi√≥n</span>
      </button>
      <button id="btn-crear-usuario" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <line x1="19" y1="8" x2="19" y2="14"></line>
          <line x1="22" y1="11" x2="16" y2="11"></line>
        </svg>
        <span>Crear usuario</span>
      </button>
      <button id="btn-cerrar-sesion" class="ribbon-btn" aria-label="Cerrar sesi√≥n">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
          <polyline points="16 17 21 12 16 7"></polyline>
          <line x1="21" y1="12" x2="9" y2="12"></line>
        </svg>
        <span>Cerrar sesi√≥n</span>
      </button>
    </div>

    <!-- M√≥dulos -->
    <div class="panel" id="panel-modulos">
      <button id="btn-ventas" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-shopping-cart-icon lucide-shopping-cart"><circle cx="8" cy="21" r="1"/><circle cx="19" cy="21" r="1"/><path d="M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12"/></svg>
        <span>Ventas</span>
      </button>
      <button id="btn-bodega" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-warehouse-icon lucide-warehouse"><path d="M18 21V10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v11"/><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 1.132-1.803l7.95-3.974a2 2 0 0 1 1.837 0l7.948 3.974A2 2 0 0 1 22 8z"/><path d="M6 13h12"/><path d="M6 17h12"/></svg>
        <span>Bodega</span>
      </button>
      <!-- ‚úÖ RENOMBRADO: "Personal" ‚Üí "Recursos Humanos" -->
      <button id="btn-rrhh" class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <span>Recursos Humanos</span>
      </button>
       <button id="btn-logistica" class="ribbon-btn">
       <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-monitor-cloud-icon lucide-monitor-cloud"><path d="M11 13a3 3 0 1 1 2.83-4H14a2 2 0 0 1 0 4z"/><path d="M12 17v4"/><path d="M8 21h8"/><rect x="2" y="3" width="20" height="14" rx="2"/></svg>
        <span>Log√≠stica</span>
      </button>
      <button id="btn-contabilidad" class="ribbon-btn">
  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calculator">
    <rect width="16" height="20" x="4" y="2" rx="2"/>
    <line x1="8" y1="6" x2="16" y2="6"/>
    <line x1="16" y1="14" x2="16" y2="18"/>
    <path d="M16 10h.01"/>
    <path d="M12 10h.01"/>
    <path d="M8 10h.01"/>
    <path d="M12 14h.01"/>
    <path d="M8 14h.01"/>
    <path d="M12 18h.01"/>
    <path d="M8 18h.01"/>
  </svg>
  <span>Contabilidad</span>
</button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clapperboard-icon lucide-clapperboard"><path d="M20.2 6l-17.55.88L3.88.88c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.9-.9c-.3-.9.9-1.66.9-1.66l-.88,7L7,7l7,7z"/><path d="m7,7 l5,5"/><path d="m7,7 l5,5"/><path d="M3,7 h5"/><path d="M3,7 h5"/></svg>
        <span>Eventos</span>
      </button>
    </div>

    <!-- Reportes -->
    <div class="panel" id="panel-reportes">
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-presentation-icon lucide-presentation"><path d="M2 3h20"/><path d="M21 3v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V3"/><path d="m7 21 5-5 5 5"/></svg>
        <span>Resumen de Eventos</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-tabs-icon lucide-notebook-tabs"><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><rect width="16" height="20" x="4" y="2" rx="2"/><path d="M15 2v20"/><path d="M15 7h5"/><path d="M15 12h5"/><path d="M15 17h5"/></svg>
        <span>Catalogo</span>
      </button>
      <!-- ‚úÖ ACTUALIZADO: Reportes de RRHH -->
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook-icon lucide-notebook"><path d="M2 6h4"/><path d="M2 10h4"/><path d="M2 14h4"/><path d="M2 18h4"/><rect width="16" height="20" x="4" y="2" rx="2"/><path d="M16 2v20"/></svg>
        <span>Manual de contrataciones</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hand-coins-icon lucide-hand-coins"><path d="M11 15h2a2 2 0 1 0 0-4h-3c-.6 0-1.1.2-1.4.6L3 17"/><path d="m7 21 1.6-1.4c.3-.4.8-.6 1.4-.6h4c1.1 0 2.1-.4 2.8-1.2l4.6-4.4a2 2 0 0 0-2.75-2.91l-4.2 3.9"/><path d="m2 16 6 6"/><circle cx="16" cy="9" r="2.9"/><circle cx="6" cy="5" r="3"/></svg>
        <span>Pagos eventual</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <polyline points="12 6 12 12 16 14"></polyline>
        </svg>
        <span>Viaticos</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 2l2 2-2 2-2-2 2-2z"></path>
          <path d="M12 6l2 2-2 2-2-2 2-2z"></path>
          <path d="M12 10l2 2-2 2-2-2 2-2z"></path>
        </svg>
        <span>Rendimientos de Vehiculos</span>
      </button>
    </div>

    <!-- Recetas -->
    <div class="panel" id="panel-recetas">
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 9v4"></path>
          <path d="M9.5 12h5"></path>
          <path d="M7.5 7h9"></path>
          <path d="M9 4h6"></path>
          <path d="M12 2v2"></path>
          <path d="M5.5 11h-2"></path>
          <path d="M18.5 11h-2"></path>
          <path d="M21 18a3 3 0 0 0-3-3H6a3 3 0 0 0-3 3v1"></path>
        </svg>
        <span>Receta 1</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 10v6"></path>
          <path d="M8 13h8"></path>
          <path d="M4 19a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1H5a1 1 0 0 0-1 1z"></path>
          <path d="M5 10V6a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v4"></path>
        </svg>
        <span>Receta 2</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="12" y1="5" x2="12" y2="19"></line>
          <line x1="5" y1="12" x2="19" y2="12"></line>
        </svg>
        <span>Nueva receta</span>
      </button>
    </div>

    <!-- Ayuda -->
    <div class="panel" id="panel-ayuda">
      <button class="ribbon-btn" id="btn-juegos">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="2" y="6" width="20" height="12" rx="2" ry="2"></rect>
          <path d="M6 12h.01"></path>
          <path d="M10 12h.01"></path>
          <path d="M14 10h.01"></path>
          <path d="M18 14h.01"></path>
        </svg>
        <span>Juegos</span>
      </button>
      <button class="ribbon-btn" id="btn-acerca">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="10"></circle>
          <line x1="12" y1="8" x2="12" y2="12"></line>
          <line x1="12" y1="16" x2="12.01" y2="16"></line>
        </svg>
        <span>Acerca de</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 9a2 2 0 0 1-2 2H8m6 0a2 2 0 0 0-2-2H8"></path>
          <path d="M8 21a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4"></path>
        </svg>
        <span>Gu√≠a r√°pida</span>
      </button>
      <button class="ribbon-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 9v2m0 4v.01"></path>
          <path d="M5 12a7 7 0 1 1 14 0 7 7 0 0 1-14 0z"></path>
        </svg>
        <span>Soluci√≥n</span>
      </button>
      <button class="ribbon-btn" id="btn-soporte">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 15a2 2 0 0 1-2 2H7l-4-4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
          <line x1="9" y1="10" x2="15" y2="10"></line>
          <line x1="9" y1="14" x2="15" y2="14"></line>
        </svg>
        <span>Soporte</span>
      </button>
      <button class="ribbon-btn" id="btn-actualizaciones">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M12 3v6h4"></path>
          <path d="M12 21v-6h4"></path>
          <path d="M16 12H9a4 4 0 0 0-4 4v1a3 3 0 0 0 3 3h8"></path>
          <path d="M8 12H3a3 3 0 0 0 3-3V8a4 4 0 0 1 4-4h1"></path>
        </svg>
        <span>Actualizaciones</span>
      </button>
      <button class="ribbon-btn" id="btn-config-ventana">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
          <line x1="9" y1="9" x2="15" y2="15"></line>
          <line x1="15" y1="9" x2="9" y2="15"></line>
        </svg>
        <span>Configuraci√≥n de ventana</span>
      </button>
      <button class="ribbon-btn" id="btn-set-dns" title="Cambiar DNS a 1.1.1.1">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M3 12h18"></path>
          <path d="M12 3v18"></path>
        </svg>
        <span>Solucionar DNS</span>
      </button>
      <button class="ribbon-btn" id="btn-restore-dns" title="Restaurar configuraci√≥n de DNS previa">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 12H3"></path>
          <path d="M12 21V3"></path>
        </svg>
        <span>Restaurar DNS</span>
      </button>
    </div>
  </div>

  <!-- √Årea de contenido CON ID -->
  <div class="content-area" id="contenido-principal">
    <div class="login-wrapper">
      <div class="login-card">
        <h2>Iniciar Sesi√≥n</h2>
        <div class="face-wrap">
          <img id="faceImg" class="face-img" src="./assets/1.png" alt="Personaje" aria-hidden="true" />
        </div>
        <form id="formLogin">
          <div class="input-group">
            <label for="usuario">Usuario</label>
            <input type="text" id="usuario" autocomplete="username" required />
          </div>
          <div class="input-group">
            <label for="contrasena">Contrase√±a</label>
            <div class="password-wrap" style="position:relative;">
              <input type="password" id="contrasena" autocomplete="current-password" required style="padding-right:44px;" />
              <button type="button" id="toggle-password" class="toggle-password" aria-label="Mostrar contrase√±a" title="Mostrar contrase√±a" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);border:none;background:transparent;padding:6px;cursor:pointer;display:flex;align-items:center;justify-content:center;">
                <svg class="icon-eye" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#374151" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8S1 12 1 12z"></path><circle cx="12" cy="12" r="3"></circle></svg>
              </button>
            </div>
          </div>
          <button type="submit" class="btn">Ingresar</button>
        </form>
        <div class="footer-links">¬øNo tienes cuenta? <a href="#" id="link-registro">Registrarse</a></div>
      </div>
    </div>
  </div>

  <!-- Modal de configuraci√≥n de ventana -->
  <div id="modal-config-ventana" class="modal-overlay" style="display: none;">
    <div class="modal-content" style="max-width: 500px;">
      <div class="modal-header">
        <h3>Configuraci√≥n de Ventana</h3>
        <button id="btn-cerrar-config-ventana" class="modal-close">‚úï</button>
      </div>
      <div class="modal-body">
        <p style="margin-bottom: 20px; color: #666;">Elige c√≥mo se comporta el tama√±o de la ventana de la aplicaci√≥n:</p>

        <div style="margin-bottom: 20px;">
          <label style="display: block; margin-bottom: 10px;">
            <input type="radio" name="window-mode" value="fixed" checked>
            <strong>Modo Fijo (Recomendado)</strong><br>
            <small style="color: #666;">La ventana siempre mide 1200x800 p√≠xeles, igual que ahora</small>
          </label>

          <label style="display: block; margin-bottom: 10px;">
            <input type="radio" name="window-mode" value="responsive">
            <strong>Modo Responsivo</strong><br>
            <small style="color: #666;">La ventana se adapta al 80% del tama√±o de tu pantalla</small>
          </label>
        </div>

        <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
          <strong>‚ö†Ô∏è Importante:</strong> Los cambios se aplicar√°n al reiniciar la aplicaci√≥n.
        </div>

        <div style="display: flex; gap: 10px; justify-content: flex-end;">
          <button id="btn-guardar-config-ventana" class="ribbon-btn" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            üíæ Guardar y Reiniciar
          </button>
          <button id="btn-cancelar-config-ventana" class="ribbon-btn" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            Cancelar
          </button>
        </div>
      </div>
    </div>
  </div>

  <script>
    // =============================================================================  
    // üîπ CARGAR M√ìDULOS DIN√ÅMICAMENTE
    // =============================================================================  
    function cargarModulo(url) {
        const contenedor = document.getElementById('contenido-principal');
        fetch(url)
          .then(async response => {
            if (!response.ok) throw new Error(`Error al cargar ${url}`);
            const html = await response.text();
            return { html, response };
          })
          .then(({ html, response }) => {
            try {
              const parser = new DOMParser();
              const doc = parser.parseFromString(html, 'text/html');

              // Inyectar hojas de estilo encontradas en la respuesta
              const links = Array.from(doc.querySelectorAll('link[rel="stylesheet"]'));
              links.forEach(l => {
                try {
                  const href = l.getAttribute('href');
                  if (!href) return;
                  const resolved = new URL(href, response.url).href;
                  const exists = Array.from(document.head.querySelectorAll('link[rel="stylesheet"]'))
                    .some(h => h.href === resolved || h.getAttribute('href') === href || h.href.endsWith(href));
                  if (!exists) {
                    const linkTag = document.createElement('link');
                    linkTag.rel = 'stylesheet';
                    linkTag.href = resolved;
                    document.head.appendChild(linkTag);
                  }
                } catch (e) { console.warn('failed to inject stylesheet', e); }
              });

              // Extraer body, aplicar clases del body del m√≥dulo al body principal y scripts
              const bodyHtml = doc.body.innerHTML;

              // Aplicar clases del <body> del m√≥dulo al body principal para que las reglas scoped funcionen.
              try {
                const moduleBodyClass = doc.body.getAttribute('class') || '';
                // Remover clases previamente a√±adidas por m√≥dulos anteriores
                if (window._lastModuleBodyClasses && Array.isArray(window._lastModuleBodyClasses)) {
                  window._lastModuleBodyClasses.forEach(c => document.body.classList.remove(c));
                }
                window._lastModuleBodyClasses = [];
                if (moduleBodyClass.trim()) {
                  const classes = moduleBodyClass.split(/\s+/).filter(Boolean);
                  classes.forEach(c => document.body.classList.add(c));
                  window._lastModuleBodyClasses = classes;
                }
              } catch (e) { console.warn('No se pudo aplicar clases de body del m√≥dulo', e); }

              const scripts = Array.from(doc.querySelectorAll('script'));

              // Insertar HTML
              contenedor.innerHTML = bodyHtml;

              // Inyectar scripts (resolver src relativo a la respuesta)
              scripts.forEach(s => {
                const tag = document.createElement('script');
                if (s.src) {
                  try {
                    const srcAttr = s.getAttribute('src');
                    tag.src = srcAttr ? new URL(srcAttr, response.url).href : s.src;
                  } catch (e) { tag.src = s.src; }
                } else {
                  tag.textContent = s.textContent;
                }
                contenedor.appendChild(tag);
              });
              return;
            } catch (e) {
              console.error('Error procesando m√≥dulo:', e);
            }

            // Fallback
            contenedor.innerHTML = html;
          })
          .catch(err => {
            console.error(err);
            contenedor.innerHTML = `<p style="color: red; padding: 20px;">‚ùå Error al cargar el m√≥dulo: ${err.message}</p>`;
          });
    }

    // =============================================================================  
    // üîπ EVENTOS DE BOTONES
    // =============================================================================  
   // Handler movido a renderer.js con control de sesi√≥n; evitamos cargar log√≠stica sin login.

    // Puedes a√±adir m√°s botones aqu√≠
    // document.getElementById('btn-bodega').addEventListener('click', () => {
    //   cargarModulo('modules/bodega/inventario.html');
    // });

    // =============================================================================  
    // üîπ PESTA√ëAS (mant√©n tu l√≥gica actual)
    // =============================================================================  
    document.querySelectorAll('.tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(`panel-${tab.dataset.tab}`).classList.add('active');
      });
    });
  </script>

  <!-- Scripts del login -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script src="./src/config/supabaseClient.js"></script>
  <script src="./auth/login.js"></script>

  <script src="./renderer.js"></script>
  <script src="./libs/jspdf.min.js"></script>
  <script src="./libs/html2canvas.min.js"></script>
  <script src="./libs/html2pdf.min.js"></script>
  <script src="./libs/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

  <!-- 1. Supabase SDK (desde CDN) -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<!-- 2. Tu cliente de Supabase -->
<script src="src/config/supabaseClient.js"></script>

<!-- 3. Renderer (tu l√≥gica de app) -->
<script src="desktop/renderer.js"></script>

</body>
</html>